{"remainingRequest":"C:\\Users\\itryl\\Desktop\\projects\\vision-project\\vision原版\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\itryl\\Desktop\\projects\\vision-project\\vision原版\\src\\components\\Stock.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\itryl\\Desktop\\projects\\vision-project\\vision原版\\src\\components\\Stock.vue","mtime":1602319182000},{"path":"C:\\Users\\itryl\\Desktop\\projects\\vision-project\\vision原版\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\itryl\\Desktop\\projects\\vision-project\\vision原版\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\itryl\\Desktop\\projects\\vision-project\\vision原版\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\itryl\\Desktop\\projects\\vision-project\\vision原版\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcFN0YXRlIH0gZnJvbSAndnVleCcKZXhwb3J0IGRlZmF1bHQgewogIGRhdGEgKCkgewogICAgcmV0dXJuIHsKICAgICAgY2hhcnRJbnN0YW5jZTogbnVsbCwKICAgICAgYWxsRGF0YTogbnVsbCwKICAgICAgY3VycmVudEluZGV4OiAwLCAvLyDlvZPliY3mmL7npLrnmoTmlbDmja4KICAgICAgdGltZXJJZDogbnVsbCAvLyDlrprml7blmajnmoTmoIfor4YKICAgIH0KICB9LAogIGNyZWF0ZWQgKCkgewogICAgLy8g5Zyo57uE5Lu25Yib5bu65a6M5oiQ5LmL5ZCOIOi/m+ihjOWbnuiwg+WHveaVsOeahOazqOWGjAogICAgdGhpcy4kc29ja2V0LnJlZ2lzdGVyQ2FsbEJhY2soJ3N0b2NrRGF0YScsIHRoaXMuZ2V0RGF0YSkKICB9LAogIG1vdW50ZWQgKCkgewogICAgdGhpcy5pbml0Q2hhcnQoKQogICAgLy8gdGhpcy5nZXREYXRhKCkKICAgIHRoaXMuJHNvY2tldC5zZW5kKHsKICAgICAgYWN0aW9uOiAnZ2V0RGF0YScsCiAgICAgIHNvY2tldFR5cGU6ICdzdG9ja0RhdGEnLAogICAgICBjaGFydE5hbWU6ICdzdG9jaycsCiAgICAgIHZhbHVlOiAnJwogICAgfSkKICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLnNjcmVlbkFkYXB0ZXIpCiAgICB0aGlzLnNjcmVlbkFkYXB0ZXIoKQogIH0sCiAgZGVzdHJveWVkICgpIHsKICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLnNjcmVlbkFkYXB0ZXIpCiAgICBjbGVhckludGVydmFsKHRoaXMudGltZXJJZCkKICAgIHRoaXMuJHNvY2tldC51blJlZ2lzdGVyQ2FsbEJhY2soJ3N0b2NrRGF0YScpCiAgfSwKICBtZXRob2RzOiB7CiAgICBpbml0Q2hhcnQgKCkgewogICAgICB0aGlzLmNoYXJ0SW5zdGFuY2UgPSB0aGlzLiRlY2hhcnRzLmluaXQodGhpcy4kcmVmcy5zdG9ja19yZWYsIHRoaXMudGhlbWUpCiAgICAgIGNvbnN0IGluaXRPcHRpb24gPSB7CiAgICAgICAgdGl0bGU6IHsKICAgICAgICAgIHRleHQ6ICfilo7lupPlrZjlkozplIDph4/liIbmnpAnLAogICAgICAgICAgbGVmdDogMjAsCiAgICAgICAgICB0b3A6IDIwCiAgICAgICAgfQogICAgICB9CiAgICAgIHRoaXMuY2hhcnRJbnN0YW5jZS5zZXRPcHRpb24oaW5pdE9wdGlvbikKICAgICAgdGhpcy5jaGFydEluc3RhbmNlLm9uKCdtb3VzZW92ZXInLCAoKSA9PiB7CiAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnRpbWVySWQpCiAgICAgIH0pCiAgICAgIHRoaXMuY2hhcnRJbnN0YW5jZS5vbignbW91c2VvdXQnLCAoKSA9PiB7CiAgICAgICAgdGhpcy5zdGFydEludGVydmFsKCkKICAgICAgfSkKICAgIH0sCiAgICBnZXREYXRhIChyZXQpIHsKICAgICAgLy8g6I635Y+W5pyN5Yqh5Zmo55qE5pWw5o2uLCDlr7l0aGlzLmFsbERhdGHov5vooYzotYvlgLzkuYvlkI4sIOiwg+eUqHVwZGF0ZUNoYXJ05pa55rOV5pu05paw5Zu+6KGoCiAgICAgIC8vIGNvbnN0IHsgZGF0YTogcmV0IH0gPSBhd2FpdCB0aGlzLiRodHRwLmdldCgnc3RvY2snKQogICAgICB0aGlzLmFsbERhdGEgPSByZXQKICAgICAgY29uc29sZS5sb2codGhpcy5hbGxEYXRhKQogICAgICB0aGlzLnVwZGF0ZUNoYXJ0KCkKICAgICAgdGhpcy5zdGFydEludGVydmFsKCkKICAgIH0sCiAgICB1cGRhdGVDaGFydCAoKSB7CiAgICAgIGNvbnN0IGNlbnRlckFyciA9IFsKICAgICAgICBbJzE4JScsICc0MCUnXSwKICAgICAgICBbJzUwJScsICc0MCUnXSwKICAgICAgICBbJzgyJScsICc0MCUnXSwKICAgICAgICBbJzM0JScsICc3NSUnXSwKICAgICAgICBbJzY2JScsICc3NSUnXQogICAgICBdCiAgICAgIGNvbnN0IGNvbG9yQXJyID0gWwogICAgICAgIFsnIzRGRjc3OCcsICcjMEJBODJDJ10sCiAgICAgICAgWycjRTVERDQ1JywgJyNFOEIxMUMnXSwKICAgICAgICBbJyNFODgyMUMnLCAnI0U1NTQ0NSddLAogICAgICAgIFsnIzUwNTJFRScsICcjQUI2RUU1J10sCiAgICAgICAgWycjMjNFNUU1JywgJyMyRTcyQkYnXQogICAgICBdCiAgICAgIC8vIOWkhOeQhuWbvuihqOmcgOimgeeahOaVsOaNrgogICAgICBjb25zdCBzdGFydCA9IHRoaXMuY3VycmVudEluZGV4ICogNQogICAgICBjb25zdCBlbmQgPSAodGhpcy5jdXJyZW50SW5kZXggKyAxKSAqIDUKICAgICAgY29uc3Qgc2hvd0RhdGEgPSB0aGlzLmFsbERhdGEuc2xpY2Uoc3RhcnQsIGVuZCkKICAgICAgY29uc3Qgc2VyaWVzQXJyID0gc2hvd0RhdGEubWFwKChpdGVtLCBpbmRleCkgPT4gewogICAgICAgIHJldHVybiB7CiAgICAgICAgICB0eXBlOiAncGllJywKICAgICAgICAgIGNlbnRlcjogY2VudGVyQXJyW2luZGV4XSwKICAgICAgICAgIGhvdmVyQW5pbWF0aW9uOiBmYWxzZSwgLy8g5YWz6Zet6byg5qCH56e75YWl5Yiw6aW85Zu+5pe255qE5Yqo55S75pWI5p6cCiAgICAgICAgICBsYWJlbExpbmU6IHsKICAgICAgICAgICAgc2hvdzogZmFsc2UgLy8g6ZqQ6JeP5oyH56S657q/CiAgICAgICAgICB9LAogICAgICAgICAgbGFiZWw6IHsKICAgICAgICAgICAgcG9zaXRpb246ICdjZW50ZXInLAogICAgICAgICAgICBjb2xvcjogY29sb3JBcnJbaW5kZXhdWzBdCiAgICAgICAgICB9LAogICAgICAgICAgZGF0YTogWwogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbmFtZTogaXRlbS5uYW1lICsgJ1xuXG4nICsgaXRlbS5zYWxlcywKICAgICAgICAgICAgICB2YWx1ZTogaXRlbS5zYWxlcywKICAgICAgICAgICAgICBpdGVtU3R5bGU6IHsKICAgICAgICAgICAgICAgIGNvbG9yOiBuZXcgdGhpcy4kZWNoYXJ0cy5ncmFwaGljLkxpbmVhckdyYWRpZW50KDAsIDEsIDAsIDAsIFsKICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIG9mZnNldDogMCwKICAgICAgICAgICAgICAgICAgICBjb2xvcjogY29sb3JBcnJbaW5kZXhdWzBdCiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBvZmZzZXQ6IDEsCiAgICAgICAgICAgICAgICAgICAgY29sb3I6IGNvbG9yQXJyW2luZGV4XVsxXQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgIHZhbHVlOiBpdGVtLnN0b2NrLAogICAgICAgICAgICAgIGl0ZW1TdHlsZTogewogICAgICAgICAgICAgICAgY29sb3I6ICcjMzMzODQzJwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgXQogICAgICAgIH0KICAgICAgfSkKICAgICAgY29uc3QgZGF0YU9wdGlvbiA9IHsKICAgICAgICBzZXJpZXM6IHNlcmllc0FycgogICAgICB9CiAgICAgIHRoaXMuY2hhcnRJbnN0YW5jZS5zZXRPcHRpb24oZGF0YU9wdGlvbikKICAgIH0sCiAgICBzY3JlZW5BZGFwdGVyICgpIHsKICAgICAgY29uc3QgdGl0bGVGb250U2l6ZSA9IHRoaXMuJHJlZnMuc3RvY2tfcmVmLm9mZnNldFdpZHRoIC8gMTAwICogMy42CiAgICAgIGNvbnN0IGlubmVyUmFkaXVzID0gdGl0bGVGb250U2l6ZSAqIDIuOAogICAgICBjb25zdCBvdXR0ZXJSYWRpdXMgPSBpbm5lclJhZGl1cyAqIDEuMTI1CiAgICAgIGNvbnN0IGFkYXB0ZXJPcHRpb24gPSB7CiAgICAgICAgdGl0bGU6IHsKICAgICAgICAgIHRleHRTdHlsZTogewogICAgICAgICAgICBmb250U2l6ZTogdGl0bGVGb250U2l6ZQogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgc2VyaWVzOiBbCiAgICAgICAgICB7CiAgICAgICAgICAgIHR5cGU6ICdwaWUnLAogICAgICAgICAgICByYWRpdXM6IFtvdXR0ZXJSYWRpdXMsIGlubmVyUmFkaXVzXSwKICAgICAgICAgICAgbGFiZWw6IHsKICAgICAgICAgICAgICBmb250U2l6ZTogdGl0bGVGb250U2l6ZSAvIDIKICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgdHlwZTogJ3BpZScsCiAgICAgICAgICAgIHJhZGl1czogW291dHRlclJhZGl1cywgaW5uZXJSYWRpdXNdLAogICAgICAgICAgICBsYWJlbDogewogICAgICAgICAgICAgIGZvbnRTaXplOiB0aXRsZUZvbnRTaXplIC8gMgogICAgICAgICAgICB9CiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICB0eXBlOiAncGllJywKICAgICAgICAgICAgcmFkaXVzOiBbb3V0dGVyUmFkaXVzLCBpbm5lclJhZGl1c10sCiAgICAgICAgICAgIGxhYmVsOiB7CiAgICAgICAgICAgICAgZm9udFNpemU6IHRpdGxlRm9udFNpemUgLyAyCiAgICAgICAgICAgIH0KICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIHR5cGU6ICdwaWUnLAogICAgICAgICAgICByYWRpdXM6IFtvdXR0ZXJSYWRpdXMsIGlubmVyUmFkaXVzXSwKICAgICAgICAgICAgbGFiZWw6IHsKICAgICAgICAgICAgICBmb250U2l6ZTogdGl0bGVGb250U2l6ZSAvIDIKICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgdHlwZTogJ3BpZScsCiAgICAgICAgICAgIHJhZGl1czogW291dHRlclJhZGl1cywgaW5uZXJSYWRpdXNdLAogICAgICAgICAgICBsYWJlbDogewogICAgICAgICAgICAgIGZvbnRTaXplOiB0aXRsZUZvbnRTaXplIC8gMgogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgXQogICAgICB9CiAgICAgIHRoaXMuY2hhcnRJbnN0YW5jZS5zZXRPcHRpb24oYWRhcHRlck9wdGlvbikKICAgICAgdGhpcy5jaGFydEluc3RhbmNlLnJlc2l6ZSgpCiAgICB9LAogICAgc3RhcnRJbnRlcnZhbCAoKSB7CiAgICAgIGlmICh0aGlzLnRpbWVySWQpIHsKICAgICAgICBjbGVhckludGVydmFsKHRoaXMudGltZXJJZCkKICAgICAgfQogICAgICB0aGlzLnRpbWVySWQgPSBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICAgICAgdGhpcy5jdXJyZW50SW5kZXgrKwogICAgICAgIGlmICh0aGlzLmN1cnJlbnRJbmRleCA+IDEpIHsKICAgICAgICAgIHRoaXMuY3VycmVudEluZGV4ID0gMAogICAgICAgIH0KICAgICAgICB0aGlzLnVwZGF0ZUNoYXJ0KCkgLy8g5Zyo5pu05pS55a6MY3VycmVudEluZGV45LmL5ZCOICwg6ZyA6KaB5pu05paw55WM6Z2iCiAgICAgIH0sIDUwMDApCiAgICB9CiAgfSwKICBjb21wdXRlZDogewogICAgLi4ubWFwU3RhdGUoWyd0aGVtZSddKQogIH0sCiAgd2F0Y2g6IHsKICAgIHRoZW1lICgpIHsKICAgICAgY29uc29sZS5sb2coJ+S4u+mimOWIh+aNouS6hicpCiAgICAgIHRoaXMuY2hhcnRJbnN0YW5jZS5kaXNwb3NlKCkgLy8g6ZSA5q+B5b2T5YmN55qE5Zu+6KGoCiAgICAgIHRoaXMuaW5pdENoYXJ0KCkgLy8g6YeN5paw5Lul5pyA5paw55qE5Li76aKY5ZCN56ew5Yid5aeL5YyW5Zu+6KGo5a+56LGhCiAgICAgIHRoaXMuc2NyZWVuQWRhcHRlcigpIC8vIOWujOaIkOWxj+W5leeahOmAgumFjQogICAgICB0aGlzLnVwZGF0ZUNoYXJ0KCkgLy8g5pu05paw5Zu+6KGo55qE5bGV56S6CiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["Stock.vue"],"names":[],"mappings":";;;;;;;;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Stock.vue","sourceRoot":"src/components","sourcesContent":["<!-- 库存销量分析 -->\n<template>\n  <div class='com-container'>\n    <div class='com-chart' ref='stock_ref'></div>\n  </div>\n</template>\n\n<script>\nimport { mapState } from 'vuex'\nexport default {\n  data () {\n    return {\n      chartInstance: null,\n      allData: null,\n      currentIndex: 0, // 当前显示的数据\n      timerId: null // 定时器的标识\n    }\n  },\n  created () {\n    // 在组件创建完成之后 进行回调函数的注册\n    this.$socket.registerCallBack('stockData', this.getData)\n  },\n  mounted () {\n    this.initChart()\n    // this.getData()\n    this.$socket.send({\n      action: 'getData',\n      socketType: 'stockData',\n      chartName: 'stock',\n      value: ''\n    })\n    window.addEventListener('resize', this.screenAdapter)\n    this.screenAdapter()\n  },\n  destroyed () {\n    window.removeEventListener('resize', this.screenAdapter)\n    clearInterval(this.timerId)\n    this.$socket.unRegisterCallBack('stockData')\n  },\n  methods: {\n    initChart () {\n      this.chartInstance = this.$echarts.init(this.$refs.stock_ref, this.theme)\n      const initOption = {\n        title: {\n          text: '▎库存和销量分析',\n          left: 20,\n          top: 20\n        }\n      }\n      this.chartInstance.setOption(initOption)\n      this.chartInstance.on('mouseover', () => {\n        clearInterval(this.timerId)\n      })\n      this.chartInstance.on('mouseout', () => {\n        this.startInterval()\n      })\n    },\n    getData (ret) {\n      // 获取服务器的数据, 对this.allData进行赋值之后, 调用updateChart方法更新图表\n      // const { data: ret } = await this.$http.get('stock')\n      this.allData = ret\n      console.log(this.allData)\n      this.updateChart()\n      this.startInterval()\n    },\n    updateChart () {\n      const centerArr = [\n        ['18%', '40%'],\n        ['50%', '40%'],\n        ['82%', '40%'],\n        ['34%', '75%'],\n        ['66%', '75%']\n      ]\n      const colorArr = [\n        ['#4FF778', '#0BA82C'],\n        ['#E5DD45', '#E8B11C'],\n        ['#E8821C', '#E55445'],\n        ['#5052EE', '#AB6EE5'],\n        ['#23E5E5', '#2E72BF']\n      ]\n      // 处理图表需要的数据\n      const start = this.currentIndex * 5\n      const end = (this.currentIndex + 1) * 5\n      const showData = this.allData.slice(start, end)\n      const seriesArr = showData.map((item, index) => {\n        return {\n          type: 'pie',\n          center: centerArr[index],\n          hoverAnimation: false, // 关闭鼠标移入到饼图时的动画效果\n          labelLine: {\n            show: false // 隐藏指示线\n          },\n          label: {\n            position: 'center',\n            color: colorArr[index][0]\n          },\n          data: [\n            {\n              name: item.name + '\\n\\n' + item.sales,\n              value: item.sales,\n              itemStyle: {\n                color: new this.$echarts.graphic.LinearGradient(0, 1, 0, 0, [\n                  {\n                    offset: 0,\n                    color: colorArr[index][0]\n                  },\n                  {\n                    offset: 1,\n                    color: colorArr[index][1]\n                  }\n                ])\n              }\n            },\n            {\n              value: item.stock,\n              itemStyle: {\n                color: '#333843'\n              }\n            }\n          ]\n        }\n      })\n      const dataOption = {\n        series: seriesArr\n      }\n      this.chartInstance.setOption(dataOption)\n    },\n    screenAdapter () {\n      const titleFontSize = this.$refs.stock_ref.offsetWidth / 100 * 3.6\n      const innerRadius = titleFontSize * 2.8\n      const outterRadius = innerRadius * 1.125\n      const adapterOption = {\n        title: {\n          textStyle: {\n            fontSize: titleFontSize\n          }\n        },\n        series: [\n          {\n            type: 'pie',\n            radius: [outterRadius, innerRadius],\n            label: {\n              fontSize: titleFontSize / 2\n            }\n          },\n          {\n            type: 'pie',\n            radius: [outterRadius, innerRadius],\n            label: {\n              fontSize: titleFontSize / 2\n            }\n          },\n          {\n            type: 'pie',\n            radius: [outterRadius, innerRadius],\n            label: {\n              fontSize: titleFontSize / 2\n            }\n          },\n          {\n            type: 'pie',\n            radius: [outterRadius, innerRadius],\n            label: {\n              fontSize: titleFontSize / 2\n            }\n          },\n          {\n            type: 'pie',\n            radius: [outterRadius, innerRadius],\n            label: {\n              fontSize: titleFontSize / 2\n            }\n          }\n        ]\n      }\n      this.chartInstance.setOption(adapterOption)\n      this.chartInstance.resize()\n    },\n    startInterval () {\n      if (this.timerId) {\n        clearInterval(this.timerId)\n      }\n      this.timerId = setInterval(() => {\n        this.currentIndex++\n        if (this.currentIndex > 1) {\n          this.currentIndex = 0\n        }\n        this.updateChart() // 在更改完currentIndex之后 , 需要更新界面\n      }, 5000)\n    }\n  },\n  computed: {\n    ...mapState(['theme'])\n  },\n  watch: {\n    theme () {\n      console.log('主题切换了')\n      this.chartInstance.dispose() // 销毁当前的图表\n      this.initChart() // 重新以最新的主题名称初始化图表对象\n      this.screenAdapter() // 完成屏幕的适配\n      this.updateChart() // 更新图表的展示\n    }\n  }\n}\n</script>\n\n<style lang='less' scoped>\n</style>\n"]}]}